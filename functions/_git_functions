#! /bin/zsh
# Assorted git functions

# move forward linearly a given number of commits
function gforw() {
  git checkout $(git rev-list --topo-order HEAD..master | tail -$1 | head -1)
}

# move back linearly a given number of commits
function gback() { git checkout HEAD~$1 }

# make a quick fix at a previous commit
function gfix() {
  gback "$1"

  # attempts to delete fix if already merged
  if [ -n "$(git show-ref refs/heads/fix)" ]; then
    git branch -d fix
  fi

  git checkout -b fix
}

# rebase given branch on fix branch
function gffix() {
  # abort if no branch given
  [[ -z $1 ]] && return 1

  git checkout "$1"
  git rebase -i fix
  git branch -d fix
}

# delete given branch locally & remotely
function gdel() {
  # abort if no branch given
  [[ -z $1 ]] && return 1

  git branch -D $1
  git push origin -d $1
}
